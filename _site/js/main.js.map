{"version":3,"sources":["display.js","dom_elements.js","fontscale.js","game_logic.js","global_util.js","inputs_handler.js","save_file.js","word_generator.js"],"names":["display","this","modify","getContentProperty","element","nodeName","replaceElementContent","content","getElementContent","toggleAttribute","attribute","getAttribute","removeAttribute","setAttribute","toggleDrawer","elements","list","input","drawer","setTimeout","fontScale","recalculate","replaceOrGetContent","undefined","updateReadout","obj","current_level","save_file","get","current_stage","current_score","level","textReadoutScore","textReadoutHighscore","highscore","textReadoutLevel","textReadoutLevelinfo","info","counter","read","parseInt","text","count","innerHTML","toggleTheme","a","document","body","getReferenceItem","number","ms_array","join","getMenuItem","stage_num","level_num","s","state","selectLevel","override","current_lvl","querySelector","select","firstChild","next_lvl","radio","next_stage","getLevelsList","i","getReferenceList","setMenuTabs","tabs","selected","length","value","updateReferenceList","reference","updateLevelsLists","stage_nums","triggerElementGlow","color","style","transition","boxShadow","goodGlow","main","badGlow","__generateSpecifics","lvl","path","valid","nodeType","e","console","error","index","titleCase","Function","bind","init","__s","mainsection","tabmenu","container","levels","readout","settings","generator","score","levelinfo","stage1","button","stage2","skip","theme","reset","tab_labels","local_dict","filechooser","messages","prompt_dict","message","word","nums","output","item","found","querySelectorAll","maxSize","wordWrap","addWrapper","recalculateElement","resetScale","eh","offsetHeight","ew","offsetWidth","ph","getNominalHeight","pw","getNominalWidth","height_ratio","Math","max","width_ratio","scaleByRatio","ratio","fontSize","min","parentElement","mh","Infinity","mw","classList","game","generate","generateWord","generateNum","textMain","__generateWordFromFormat","format","random_word_index","generated_word","words","WordGenerator","dictionaryLoaded","getWordsFromNum","__generateNumFromFormat","split","round","random","push","checkWord","removeEmpty","check_nums","explodePossibleNumToNums","possibleNumFromWord","n","groups","result","digit_range","__generateDigitGroup","range","single_digit","break_probability","checkNum","num","__matchPossibleNum","letters","__wordToLetters","possible_num","ms","indexOf","__letterToNums","explodedNums","max_index","__recursiveSerialJoinArrays","arrays","reduced_arrays","slice","__serialJoinArrays","next_array","arr1","arr2","b","toString","exploded","removeSuccessiveDuplicates","trim","toLowerCase","multi","letter","exploded_num","addTimestamp","timestamp","updateScore","times","level_i","__calculateScore","set","MAX_PAST","scaler","timelen","pastinterval","timediff","wpm","reload","window","location","array","floor","Date","now","string","toUpperCase","0","1","2","3","4","5","6","7","8","9","getTime","inputs","themeListener","generateNums","generatorInputWord","tail","inputElement","generatorOutputNums","splice","placeholder","generateNumsListener","keyCode","generateWordListener","getWord","generatorInputNumber","generatorOutputWord","tabsListener","checked","drawerListener","skipListener","resetListener","detail","clearDictionaryFromLocalStorage","stageSelectListener","clicked","reverseDomSearch","target","match","log","levelSelectListener","new_level","inputMain","target_element_name","target_element","mainInputListener","check","addEventListener","__appdata__","storage_key","expert_scale","master_scale","drawer_open","tab_selected","dark_theme","pass","10","save","localStorage","setItem","JSON","stringify","load","parse","getItem","key","removeItem","stage","dictUrl","dictUuid","dictionaryError","requestDictionary","localStorage_db","onDictionaryGet","isOffline","requestLocalFile","promptForDictionary","getfileSize","size","inputPrompt_dictButton","toFixed","ajaxMakeRequest","onDictionaryError","inputPrompt_dictMessage","url","callback","xhr","XMLHttpRequest","open","readyState","DONE","status","getResponseHeader","send","success","failure","response","call","superclass","dictionaryToDatabase","readLocalFile","preventDefault","stopPropagation","file","files","reader","FileReader","onload","evt","inputLocal_dictMessages","err","readAsText","href","dict","msg","db","Error","warn","matchesDictionaryFilter","indices","test","getWordFromNum","working_set","random_index"],"mappings":"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","file":"main.js","sourcesContent":["\r\nvar display = new (function() {\r\n    // This will store the specific elements when generated on init\r\n    this.modify = {};\r\n\r\n    this.getContentProperty = function(element){\r\n        if (element.nodeName == \"INPUT\") {\r\n            return 'value'\r\n        } else {\r\n            return 'innerHTML'\r\n        }\r\n    }\r\n\r\n    this.replaceElementContent = function(element, content) {\r\n        element[this.getContentProperty(element)] = content;\r\n    }\r\n\r\n    this.getElementContent = function(element) {\r\n        return element[this.getContentProperty(element)];\r\n    }\r\n\r\n    this.toggleAttribute = function(element, attribute) {\r\n        if (element.getAttribute(attribute) !== null) {\r\n            element.removeAttribute(attribute);\r\n        } else {\r\n            element.setAttribute(attribute, '');\r\n        }\r\n    }\r\n\r\n    this.toggleDrawer = function() {\r\n        this.toggleAttribute(elements.list.input.drawer, 'checked')\r\n        setTimeout(function(){\r\n            fontScale.recalculate();\r\n        }, 325)\r\n    }\r\n\r\n    this.replaceOrGetContent = function(element, content) {\r\n        if (content === undefined){\r\n            return this.getElementContent(element);\r\n        } else {\r\n            this.replaceElementContent(element, content);\r\n            return true;\r\n        }\r\n    }\r\n\r\n    this.updateReadout = function(){\r\n        var obj = {\r\n            current_level: save_file.get('current_level'),\r\n            current_stage: save_file.get('current_stage'),\r\n            current_score: save_file.get('current_score')\r\n        }\r\n        obj.level = save_file.get('levels')[\"stage\" + obj.current_stage][obj.current_level];\r\n\r\n        this.modify.textReadoutScore(obj.current_score)\r\n        this.modify.textReadoutHighscore(obj.level.highscore)\r\n        this.modify.textReadoutLevel(\"Level \" + obj.current_level)\r\n        this.modify.textReadoutLevelinfo(obj.level.info)\r\n        return true;\r\n    }\r\n\r\n    this.counter = function() {\r\n        var read = parseInt(elements.list.text.count.innerHTML) || 0;\r\n        elements.list.text.count.innerHTML = read + 1;\r\n    }\r\n\r\n    this.toggleTheme = function() {\r\n        var a = document.body.getAttribute('dark');\r\n        if(a == false || a == undefined){\r\n            document.body.setAttribute('dark', true)\r\n        } else {\r\n            document.body.removeAttribute('dark');\r\n        }\r\n    }\r\n\r\n    this.getReferenceItem = function(number) {\r\n        return ms_array[number].join(\", \") || \"?\";\r\n    }\r\n\r\n    this.getMenuItem = function(stage_num, level_num) {\r\n        var obj = save_file.get('levels')[\"stage\" + stage_num][level_num], s;\r\n        if (save_file.get('current_level') == level_num){\r\n            s = \"selected\";\r\n        } else {\r\n            s = \"\";\r\n        }\r\n        return \"<li \" + s + \" levelnum='\" + level_num + \"'><h4>Level \" + level_num + \"<span>\" + obj.highscore + \"</span></h4>\\n<small>\" + obj.info + \"</small><span progression=\\\"\" + obj.state() + \"\\\"></span></li>\\n\";\r\n    }\r\n\r\n    this.selectLevel = function(stage_num, level_num, override){\r\n        var current_lvl = document.querySelector('.select#stage-select-' + stage_num + ' li[selected]') || elements.list.text.select[\"stage\"+ stage_num].firstChild,\r\n            next_lvl = document.querySelector('.select#stage-select-' + stage_num + ' li[levelnum=\"' + level_num + '\"]'),\r\n            current_stage = document.querySelector('input[checked]#stage-tab-' + stage_num) || elements.list.text.select[\"stage\" + stage_num].radio,\r\n            next_stage = elements.list.text.select[\"stage\" + stage_num].radio;\r\n\r\n        if ((current_stage === next_stage || !next_stage) && !override) {\r\n            // Well, cram. Now what? Do nothing?\r\n        } else {\r\n            current_stage.removeAttribute('checked');\r\n            next_stage.setAttribute('checked', '');\r\n        };\r\n\r\n        if ((current_lvl === next_lvl || !next_lvl) && !override) {\r\n            // Well, plerm. Now what? Do nothing?\r\n        } else {\r\n            current_lvl.removeAttribute('selected');\r\n            next_lvl.setAttribute('selected', '');\r\n        };\r\n        return true\r\n    }\r\n\r\n    this.getLevelsList = function(stage_num) {\r\n        var obj = save_file.get('levels')[\"stage\" + stage_num],\r\n            list = \"\";\r\n\r\n        for (i in obj) {\r\n            list += this.getMenuItem(stage_num, i);\r\n        }\r\n        return list\r\n    }\r\n\r\n    this.getReferenceList = function() {\r\n        var list = \"\";\r\n        for (var i = 0; i <= 9; i++) {\r\n            list += \"<tr><td>\" + i + \"</td> <td>\" + this.getReferenceItem(i) + \"</td></tr>\";\r\n        };\r\n        return list;\r\n    }\r\n\r\n    this.setMenuTabs = function(){\r\n        var a = elements.list.input.tabs,\r\n            selected = save_file.get('tab_selected');\r\n        for (var i = 0; i < a.length; i++) {\r\n            if(a[i].value === selected){\r\n                a[i].setAttribute('checked', '');\r\n            }\r\n        }\r\n    }\r\n\r\n    this.updateReferenceList = function() {\r\n        this.modify.reference(this.getReferenceList());\r\n    }\r\n\r\n    this.updateLevelsLists = function(stage_nums) {\r\n        for (var i in stage_nums) {\r\n            this.modify[\"textSelectStage\" + stage_nums[i] + \"List\"](this.getLevelsList(stage_nums[i]));\r\n        }\r\n    }\r\n\r\n\r\n    /* Notification / Feedback system */\r\n    this.triggerElementGlow = function(element, color){\r\n        if (!color) { return false; }\r\n\r\n        // Ultra Jank Animation of some properties\r\n\r\n        element.style.transition = 'none';\r\n        element.style.boxShadow = '0 0 0.5em ' + color + ' inset';\r\n        setTimeout(function(){\r\n            element.style.transition = \"all 2s\";\r\n        }, 20);\r\n        setTimeout(function(){\r\n            element.style.boxShadow = '';\r\n        }, 40);\r\n        return true;\r\n    }\r\n    this.goodGlow = function(){\r\n        this.triggerElementGlow(elements.list.input.main, \"#3A8900\");\r\n    };\r\n    this.badGlow = function(){\r\n        this.triggerElementGlow(elements.list.input.main, \"#B31500\");\r\n    };\r\n\r\n\r\n    /* Element specifics are auto-generated on init */\r\n    this.__generateSpecifics = function(obj, lvl, path) {\r\n        obj = obj || elements.list;\r\n        lvl = lvl || 1;\r\n        path = path || \"\";\r\n        if (lvl > 10) { return false; }\r\n\r\n        for (i in obj) {\r\n            try {\r\n                var valid = obj[i].nodeType;\r\n            } catch(e) {\r\n                console.error(\"Element selector problem:\", i, e);\r\n            }\r\n            if (valid !== undefined) {\r\n                var index = (path) ? titleCase(i) : i;\r\n                this.modify[path + index] = new Function('content', 'return this.replaceOrGetContent(this.modify.' + path + index + '__element, content);').bind(this);\r\n                this.modify[path + index + \"__element\"] = obj[i];\r\n            } else {\r\n                this.__generateSpecifics(obj[i], lvl + 1, (lvl > 1) ? path + titleCase(i) : path + i);\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n\r\n    this.init = function(){\r\n        this.__generateSpecifics()\r\n        if ( save_file.get('dark_theme') ) { this.toggleTheme() }\r\n        if ( save_file.get('drawer_open') ) { this.toggleDrawer() }\r\n        this.setMenuTabs();\r\n        this.updateLevelsLists([1, 2]);\r\n        this.updateReferenceList();\r\n        this.updateReadout();\r\n        this.selectLevel(save_file.get('current_stage'), save_file.get('current_level'), true);\r\n    }\r\n})();","var elements = new (function() {\r\n    this.__s = { // __selectors - not really meant to be used by programmers\r\n        mainsection: \".maincolumn .main\",\r\n        tabmenu: {\r\n            container: \"#drawer-tabs .tab-container\",\r\n            levels: {\r\n                container: \"#drawer-tabs .tab-container .tab-panel.levelscolumn#tab-1 \",\r\n                readout: \"#drawer-tabs .tab-container .tab-panel.levelscolumn#tab-1 .readout\",\r\n                select: \"#drawer-tabs .tab-container .tab-panel.levelscolumn#tab-1 .select\",\r\n                settings: \"#drawer-tabs .tab-container .tab-panel#tab-1 .settings\"\r\n            },\r\n            generator: {\r\n                container: \"#drawer-tabs .tab-container .tab-panel.generatorscolumn#tab-2 \",\r\n            },\r\n            reference:{\r\n                container: \"#drawer-tabs .tab-container .tab-panel.referencecolumn#tab-3 \",\r\n            }\r\n        }\r\n    }\r\n\r\n    this.list = {\r\n        text: {\r\n            main: this.__s.mainsection + \" p.generated\",\r\n            readout: {\r\n                container: this.__s.tabmenu.levels.readout,\r\n                score: this.__s.tabmenu.levels.readout + \" .score\",\r\n                highscore: this.__s.tabmenu.levels.readout + \" .highscore\",\r\n                level: this.__s.tabmenu.levels.readout + \" .level\",\r\n                levelinfo: this.__s.tabmenu.levels.readout + \" .levelinfo\"\r\n            },\r\n            select: {\r\n                stage1: {\r\n                    button: this.__s.tabmenu.levels.container + \" .stagecolumn .stagebanner[for='stage-tab-1']\",\r\n                    list: this.__s.tabmenu.levels.container + \" .stagecolumn .select#stage-select-1 ul\",\r\n                    radio: this.__s.tabmenu.levels.container + \" .stagecolumn input#stage-tab-1\"\r\n                },\r\n                stage2: {\r\n                    button: this.__s.tabmenu.levels.container + \" .stagecolumn .stagebanner[for='stage-tab-2']\",\r\n                    list: this.__s.tabmenu.levels.container + \" .stagecolumn .select#stage-select-2 ul\",\r\n                    radio: this.__s.tabmenu.levels.container + \" .stagecolumn input#stage-tab-2\"\r\n                }\r\n            },\r\n            count: this.__s.mainsection + \" .numbar span.count\"\r\n        },\r\n        button: {\r\n            skip: this.__s.mainsection + \" .numbar a.skip\",\r\n            theme: this.__s.tabmenu.levels.settings + \" input[name=theme]\",\r\n            reset: this.__s.tabmenu.levels.settings + \" input[name=reset]\"\r\n        },\r\n        input: {\r\n            main: this.__s.mainsection + \" input[name=main_input]\",\r\n            tabs: \"#drawer input[type=radio][name='drawer-tabs']\",\r\n            tab_labels: \"#drawer .tab-buttons\",\r\n            drawer: \"input[type=checkbox]#drawer-toggle\",\r\n            local_dict: {\r\n                filechooser: this.__s.tabmenu.generator.container + \" input[type=file].submit_dict\",\r\n                messages: this.__s.tabmenu.generator.container + \" p.submit_dict\"\r\n            },\r\n            prompt_dict: {\r\n                button: this.__s.tabmenu.generator.container + \" button.prompt_dict\",\r\n                message: this.__s.tabmenu.generator.container + \" p.prompt_dict\"\r\n            }\r\n        },\r\n        reference: this.__s.tabmenu.reference.container + \" table tbody\",\r\n        generator: {\r\n            container: this.__s.tabmenu.generator.container,\r\n            word: this.__s.tabmenu.generator.container + \" .inputs button#generate_word\",\r\n            nums: this.__s.tabmenu.generator.container + \" .inputs button#generate_nums\",\r\n            input: {\r\n                word: this.__s.tabmenu.generator.container + \" .inputs input[type=text]\",\r\n                number: this.__s.tabmenu.generator.container + \" .inputs input[type=number]\",\r\n            },\r\n            output: {\r\n                nums: this.__s.tabmenu.generator.container + \" span.generated_nums\",\r\n                word: this.__s.tabmenu.generator.container + \" span.generated_word\"\r\n            }\r\n        }\r\n    }\r\n\r\n    /* INIT ROUTINE */\r\n    this.init = function(obj, lvl){\r\n        obj = obj || this.list;\r\n        lvl = lvl || 1;\r\n        if (lvl > 10) {return false} // Recursion limiter - something has gone pretty wrong.\r\n\r\n\r\n        for (item in obj){\r\n            if (typeof(obj[item]) == \"string\") {\r\n                var found = document.querySelectorAll(obj[item]);\r\n                if (found.length === 1) {\r\n                    found = found[0];\r\n                }\r\n                obj[item] = found;\r\n            } else if (typeof(obj[item]) == \"object\") {\r\n                this.init(obj[item], lvl + 1)\r\n            }\r\n        }\r\n    }\r\n})();","\r\nvar fontScale = new (function(){\r\n\r\n    this.maxSize = 350;\r\n\r\n    this.init = function(){\r\n        this.elements = document.querySelectorAll(\"[fs-min-width], [fs-max-width], [fs]\");\r\n\r\n        for (var i = 0; i < this.elements.length; i++) {\r\n            this.elements[i].style.wordWrap = 'none';\r\n        };\r\n        this.recalculate();\r\n    }\r\n\r\n    this.recalculate = function(){\r\n        for (var a = 0; a < this.elements.length; a++) {\r\n            this.addWrapper(this.elements[a]);\r\n            this.recalculateElement(this.elements[a].firstChild);\r\n        };\r\n        console.info(\"Fontscale: Recalculated font size.\")\r\n    }\r\n\r\n    this.recalculateElement = function(element){\r\n        this.resetScale(element);\r\n        var eh = element.offsetHeight,\r\n            ew = element.offsetWidth,\r\n            ph = this.getNominalHeight(element),\r\n            pw = this.getNominalWidth(element),\r\n            height_ratio = Math.max(ph/eh, 0.01),\r\n            width_ratio  = Math.max(pw/ew, 0.01);\r\n        if (width_ratio < height_ratio) {\r\n            this.scaleByRatio(element, width_ratio);\r\n        } else {\r\n            this.scaleByRatio(element, height_ratio);\r\n        }\r\n    }\r\n\r\n    this.resetScale = function(element) {\r\n        this.scaleByRatio(element, 1);\r\n    }\r\n\r\n    this.scaleByRatio = function(element, ratio){\r\n        element.style.fontSize = Math.min(ratio * 100, this.maxSize) + \"%\";\r\n    }\r\n\r\n    this.getNominalHeight = function(element){\r\n        var ph = element.parentElement.offsetHeight,\r\n            mh = element.parentElement.getAttribute('fs-max-height')/100 * ph || Infinity;\r\n\r\n        return Math.min(ph, mh);\r\n    }\r\n\r\n    this.getNominalWidth = function(element){\r\n        var pw = element.parentElement.offsetWidth,\r\n            mw = element.parentElement.getAttribute('fs-max-width')/100 * pw || Infinity;\r\n\r\n        return Math.min(pw, mw);\r\n    }\r\n\r\n    this.addWrapper = function (element){\r\n        if (!element.firstChild.classList) {\r\n            element.innerHTML = \"<span class='fontscale'>\" + element.innerHTML + \"</span>\";\r\n        }\r\n    }\r\n});","var game = new (function(){\r\n\r\n    this.generate = function(){\r\n        (save_file.get('current_stage') == 2) ? this.generateWord() : this.generateNum();\r\n        fontScale.recalculate();\r\n    }\r\n\r\n    this.generateWord = function(){\r\n        display.modify.textMain(this.__generateWordFromFormat(save_file.get('levels')[\"stage\" + save_file.get('current_stage')][save_file.get('current_level')].format));\r\n    }\r\n\r\n    this.__generateWordFromFormat = function(format){\r\n        var index,\r\n            random_word_index,\r\n            generated_word,\r\n            words = [],\r\n            i = 0;\r\n\r\n        if (!WordGenerator.dictionaryLoaded) {\r\n            return WordGenerator.getWordsFromNum(0);\r\n        }\r\n\r\n        // Inefficient\r\n        while (words.length <= 0 && i < 200){\r\n            index = this.__generateNumFromFormat(format).split(' ');\r\n            for (var i = 0; i < index.length; i++) {\r\n                var generated_word = WordGenerator.getWordsFromNum(index[i]);\r\n                if (!generated_word) {\r\n                    words = [];\r\n                    break;\r\n                }\r\n                random_word_index = Math.round(Math.random() * (generated_word.length - 1));\r\n                generated_word = generated_word[random_word_index];\r\n                words.push(titleCase(generated_word));\r\n            };\r\n            i++\r\n        }\r\n        return words.join(' ');\r\n    }\r\n\r\n    this.checkWord = function(words, nums) {\r\n        nums = removeEmpty(nums.split(' '));\r\n        words = removeEmpty(words.split(' '));\r\n\r\n        for (var i in words) {\r\n            var valid = false;\r\n            if(!nums[i] || !words[i]) { return false }\r\n            check_nums = this.explodePossibleNumToNums(this.possibleNumFromWord(words[i]));\r\n            for (var n in check_nums) {\r\n                if (check_nums[n] == nums[i]) {\r\n                    valid = true;\r\n                    break;\r\n                }\r\n            }\r\n            if (valid) { continue }\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n\r\n    this.generateNum = function() {\r\n        display.modify.textMain(this.__generateNumFromFormat(save_file.get('levels')[\"stage\" + save_file.get('current_stage')][save_file.get('current_level')].format));\r\n    }\r\n\r\n    this.__generateNumFromFormat = function(format){\r\n        format = format || \"2-12\"\r\n        var groups = format.split('|');\r\n        var result = [];\r\n\r\n        for (var i = 0; i < groups.length; i++) {\r\n            var digit_range = groups[i].split('-');\r\n            result[i] = this.__generateDigitGroup(digit_range);\r\n        };\r\n\r\n        return result.join(' ');\r\n    }\r\n    this.__generateDigitGroup = function(range) {\r\n        var single_digit, result = \"\";\r\n        if (!range[1]) { range[1] = range[0]; }\r\n        var break_probability = 1 / (range[1] - range[0] + 1);\r\n\r\n        for (var i = 1; i <= range[1]; i++) {\r\n            single_digit = Math.round(Math.random()*9);\r\n            result += single_digit;\r\n            if (i >= range[0] && Math.random() <= break_probability) {\r\n                break;\r\n            };\r\n        };\r\n\r\n        return result;\r\n    }\r\n\r\n    this.checkNum = function(num, word) {\r\n        return this.__matchPossibleNum(num, this.possibleNumFromWord(word));\r\n    }\r\n\r\n    this.possibleNumFromWord = function(word){\r\n        // debugger;\r\n        var letters = this.__wordToLetters(word);\r\n        var possible_num = [];\r\n        for (var i = 0; i < letters.length; i++) {\r\n            if ( this.ms.valid.indexOf(letters[i]) < 0 ) { continue; }\r\n            possible_num.push(game.__letterToNums(letters[i]));\r\n        };\r\n        return (possible_num.length > 0) ? possible_num : false;\r\n    }\r\n\r\n    this.explodePossibleNumToNums = function(possible_num) {\r\n        if (!possible_num) { return false }\r\n        var explodedNums = [], temp = [], max_index = 0;\r\n        // Finc the longest array\r\n        for (var i = 0; i < possible_num.length; i++) {\r\n            (max_index < possible_num[i].length) ? max_index = possible_num[i].length : false;\r\n        };\r\n        // For every array of nums in possible num, recursively join them together\r\n        explodedNums = this.__recursiveSerialJoinArrays(possible_num);\r\n        return explodedNums[0];\r\n    }\r\n\r\n    // Should pass this an ARRAY\r\n    this.__recursiveSerialJoinArrays = function(arrays, lvl) {\r\n        lvl = lvl || 1;\r\n        if (lvl > 15 || !arrays) {return arrays;} // recursion limiter\r\n        var reduced_arrays = arrays.slice(1);\r\n        reduced_arrays[0] = this.__serialJoinArrays(arrays[0], arrays[1]);\r\n        var next_array = this.__recursiveSerialJoinArrays(reduced_arrays, lvl + 1);\r\n        if (next_array[0]) {\r\n            return next_array;\r\n        } else {\r\n            return arrays;\r\n        }\r\n    }\r\n\r\n    this.__serialJoinArrays = function(arr1, arr2) {\r\n        if (!arr1 || !arr2) { return false; }\r\n        var result = [];\r\n        for (var a in arr1) {\r\n            for (var b in arr2) {\r\n                result.push(arr1[a].toString() + arr2[b].toString())\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n\r\n    this.__wordToLetters = function(word) {\r\n        if (typeof(word) !== \"string\") {return false}\r\n        var letters = [],\r\n            exploded,\r\n            index;\r\n        exploded = removeSuccessiveDuplicates(word.trim().toLowerCase().split(''));\r\n\r\n        for (var i = 0; i < exploded.length; i++) {\r\n            index = this.ms.multi.indexOf(exploded[i] + exploded[i + 1]);\r\n            if (index >= 0) {\r\n                letters.push(this.ms.multi[index]);\r\n                i++ // Skip the already-processed letter\r\n            } else {\r\n                letters.push(exploded[i])\r\n            }\r\n        };\r\n\r\n        return letters\r\n    }\r\n\r\n    this.__letterToNums = function(letter) {\r\n        nums = [];\r\n        for (i in this.ms) {\r\n            if (i >= 0 && this.ms[i].indexOf(letter) >= 0) {\r\n                nums.push(i);\r\n            }\r\n        };\r\n        return nums;\r\n    }\r\n\r\n    this.__matchPossibleNum = function(num, possible_num){\r\n        exploded_num = num.split('');\r\n        if (exploded_num.length != possible_num.length) {\r\n            return false;\r\n        }\r\n        for (var i = 0; i < exploded_num.length; i++) {\r\n            if (possible_num[i].indexOf(exploded_num[i]) < 0){\r\n                return false\r\n            }\r\n        };\r\n        return true;\r\n    }\r\n\r\n    this.addTimestamp = function(){\r\n        save_file.get('times').push(timestamp());\r\n    }\r\n\r\n    this.updateScore = function(){\r\n        var obj = {\r\n            current_score: save_file.get('current_score'),\r\n            current_stage: save_file.get('current_stage'),\r\n            levels: save_file.get('levels'),\r\n            times: save_file.get('times')\r\n        };\r\n        var level_i = save_file.get('current_level');\r\n        obj.current_score = this.__calculateScore(obj)\r\n        // Set high score if current is higher\r\n        if (obj.current_score > obj.levels[\"stage\" + obj.current_stage][level_i].highscore){\r\n            obj.levels[\"stage\" + obj.current_stage][level_i].highscore = obj.current_score;\r\n        }\r\n        save_file.set(obj);\r\n    }\r\n\r\n    this.__calculateScore = function(obj) {\r\n        var MAX_PAST = 4;\r\n        var scaler = display.modify.textMain().length,\r\n            timelen = obj.times.length,\r\n            pastinterval = Math.max(Math.min(MAX_PAST, timelen), 1),\r\n            timediff = (obj.times[timelen-1] - obj.times[timelen-pastinterval]) / 1000,\r\n            wpm = Math.round(Math.min(Math.max((60)/(timediff/pastinterval), 1), 300));\r\n\r\n        if (timelen > MAX_PAST){\r\n            obj.times = obj.times.slice(-5);\r\n        }\r\n\r\n        if (pastinterval <= 2){\r\n            return 10;\r\n        }\r\n        return Math.max(Math.round(wpm*scaler), 0);\r\n    }\r\n\r\n    this.init = function(){\r\n        this.ms = ms_array;\r\n        this.generate();\r\n    }\r\n})();","\r\nvar ms_array = {\r\n    0: ['s', 'c', 'z', 'x'],\r\n    1: ['d', 't', 'th'],\r\n    2: ['n'],\r\n    3: ['m'],\r\n    4: ['r'],\r\n    5: ['l'],\r\n    6: ['ch', 'sh', 'j', 'g'],\r\n    7: ['c', 'g', 'ch', 'q', 'k', 'ng', 'ck'],\r\n    8: ['f', 'ph', 'v'],\r\n    9: ['b', 'p'],\r\n    valid: ['s', 'c', 'z', 'x', 'q', 'd', 't', 'th', 'n', 'm', 'r', 'l', 'ch', 'ck', 'sh', 'ph', 'j', 'g', 'k', 'ng', 'f', 'v', 'b', 'p'],\r\n    multi: ['ch', 'ck', 'sh', 'th', 'ng', 'ph']\r\n}\r\n\r\nfunction reload() {\r\n    window.location.reload();\r\n}\r\n\r\nfunction removeEmpty(array){\r\n    var result = [];\r\n    for (var i = 0; i < array.length; i++) {\r\n        if (array[i].length <= 0) {\r\n            continue;\r\n        } else {\r\n            result.push(array[i])\r\n        }\r\n    };\r\n    return result;\r\n}\r\n\r\nfunction removeSuccessiveDuplicates(array){\r\n    var result = []\r\n    for (var i = 0; i < array.length; i++) {\r\n        if(array[i-1] != array[i]){\r\n            result.push(array[i]);\r\n        }\r\n    };\r\n    return result\r\n}\r\n\r\nfunction timestamp(){\r\n    return Math.floor(Date.now() / 1)\r\n}\r\n\r\n// Shim for unsupporting browsers\r\nif (!Date.now) {\r\n    Date.now = function() { return new Date().getTime(); }\r\n}\r\n\r\nfunction titleCase(string){\r\n    if (!string) { return \"\"; }\r\n    return string[0].toUpperCase() + string.slice(1).toLowerCase();\r\n}","var inputs = new (function(){\r\n    this.themeListener = function(){\r\n        save_file.set('dark_theme', !save_file.get('dark_theme'));\r\n        display.toggleTheme();\r\n    }\r\n\r\n    this.generateNums = function(e){\r\n        var nums = game.explodePossibleNumToNums(game.possibleNumFromWord(display.modify.generatorInputWord())),\r\n            tail = (nums.length > 3) ? \"...\" : \"\",\r\n            inputElement = elements.list.generator.input.word;\r\n\r\n        if (!nums) {\r\n            inputElement.placeholder = inputElement.value;\r\n            display.modify.generatorInputWord('');\r\n            return false;\r\n        }\r\n\r\n        display.modify.generatorOutputNums(nums.splice(0, 3).join(', ') + tail);\r\n        inputElement.placeholder = inputElement.value;\r\n        display.modify.generatorInputWord('');\r\n    }\r\n\r\n    this.generateNumsListener = function(e) {\r\n        if (e.keyCode === 13) {\r\n            this.generateNums();\r\n        }\r\n    }\r\n\r\n    this.generateWordListener = function(e){\r\n        var word = WordGenerator.getWord(display.modify.generatorInputNumber());\r\n        display.modify.generatorOutputWord(word);\r\n    }\r\n\r\n    this.tabsListener = function(e){\r\n        var a = elements.list.input.tabs;\r\n        setTimeout(function(){\r\n            for (var i = 0; i < a.length; i++){\r\n                if (a[i].checked) {\r\n                    save_file.set('tab_selected', a[i].value)\r\n                }\r\n            }\r\n        }, 50)\r\n    }\r\n\r\n    this.drawerListener = function(e){\r\n        var state = elements.list.input.drawer.checked;\r\n        if (state) {\r\n            save_file.set('drawer_open', true);\r\n        } else {\r\n            save_file.set('drawer_open', false);\r\n        }\r\n        setTimeout(function(){\r\n            fontScale.recalculate();\r\n        }, 325)\r\n    }\r\n\r\n    this.skipListener = function(e){\r\n        game.generate();\r\n    }\r\n\r\n    this.resetListener = function(e){\r\n        if (e.detail >= 2) {\r\n            save_file.reset();\r\n            WordGenerator.clearDictionaryFromLocalStorage();\r\n            reload();\r\n        }\r\n    }\r\n\r\n    this.stageSelectListener = function(e) {\r\n        var clicked = this.reverseDomSearch(e.target, \"LABEL\"),\r\n            next_stage = clicked.getAttribute(\"for\").match(/\\d$/)[0];\r\n            console.log(next_stage)\r\n        if (save_file.get('current_stage') !== next_stage) {\r\n            save_file.set({\r\n                current_stage: next_stage,\r\n                current_level: 1\r\n            });\r\n            display.selectLevel(next_stage, 1, true);\r\n            display.updateReadout();\r\n            display.updateLevelsLists();\r\n            game.generate();\r\n        }\r\n    }\r\n\r\n    this.levelSelectListener = function(e) {\r\n        var clicked = this.reverseDomSearch(e.target, \"LI\"),\r\n            new_level = clicked.getAttribute('levelnum');\r\n        if (!clicked) { return false; }\r\n        if (display.selectLevel(save_file.get('current_stage'), new_level)) {\r\n            save_file.set({\r\n                current_score: 0,\r\n                current_level: new_level,\r\n                times: []\r\n            });\r\n            display.modify.inputMain('');\r\n            game.generate();\r\n            display.updateReadout();\r\n            fontScale.recalculate();\r\n        }\r\n    }\r\n\r\n    this.reverseDomSearch = function(element, target_element_name) {\r\n        var target_element;\r\n        for (var i = 0; i < 3; i++) {\r\n            if (element.nodeName === target_element_name){\r\n                target_element = element;\r\n                break;\r\n            } else {\r\n                element = element.parentElement;\r\n            }\r\n        }\r\n        if (!element) {\r\n            return false;\r\n        } else {\r\n            return element;\r\n        }\r\n    }\r\n\r\n    // This is messy...\r\n    this.mainInputListener = function(e){\r\n        if (e.keyCode === 13) {\r\n            var check = display.replaceOrGetContent(elements.list.text.main.firstChild) || display.modify.textMain();\r\n            if (save_file.get('current_stage') == 1) {\r\n                if (game.checkNum(check, display.modify.inputMain())){\r\n                    display.modify.inputMain('');\r\n                    display.goodGlow();\r\n                    display.counter();\r\n\r\n                    game.generateNum();\r\n                    game.addTimestamp();\r\n                    game.updateScore();\r\n\r\n                    display.updateReadout();\r\n                    display.updateLevelsLists();\r\n                    fontScale.recalculate();\r\n                } else {\r\n                    display.badGlow();\r\n                }\r\n            } else if (save_file.get('current_stage') == 2) {\r\n                if (game.checkWord(check, display.modify.inputMain())) {\r\n                    display.modify.inputMain('');\r\n                    display.goodGlow();\r\n                    display.counter();\r\n\r\n                    game.generateWord();\r\n                    game.addTimestamp();\r\n                    game.updateScore();\r\n\r\n                    display.updateReadout();\r\n                    display.updateLevelsLists();\r\n                    fontScale.recalculate();\r\n                } else {\r\n                    display.badGlow();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    this.init = function(){\r\n        elements.list.button.theme.addEventListener('click', this.themeListener);\r\n        elements.list.button.reset.addEventListener('click', this.resetListener);\r\n        elements.list.button.skip.addEventListener('click', this.skipListener);\r\n\r\n        elements.list.text.select.stage1.list.addEventListener('click', this.levelSelectListener.bind(this));\r\n        elements.list.text.select.stage2.list.addEventListener('click', this.levelSelectListener.bind(this));\r\n        elements.list.text.select.stage1.button.addEventListener('click', this.stageSelectListener.bind(this));\r\n        elements.list.text.select.stage2.button.addEventListener('click', this.stageSelectListener.bind(this));\r\n\r\n        elements.list.generator.word.addEventListener('click', this.generateWordListener);\r\n        elements.list.generator.nums.addEventListener('click', this.generateNums);\r\n        elements.list.generator.input.word.addEventListener('keyup', this.generateNumsListener.bind(this));\r\n\r\n        elements.list.input.main.addEventListener('keyup', this.mainInputListener);\r\n        elements.list.input.drawer.addEventListener('click', this.drawerListener);\r\n        elements.list.input.tab_labels.addEventListener('click', this.tabsListener);\r\n    }\r\n})();","\r\nvar save_file = new (function() {\r\n    // This is the data that gets saved between game states. Functions for manipulating are in save_file.\r\n    this.__appdata__ = {\r\n        storage_key: \"major_training_242e9989-ffa2-48b6-8f46-4b7dfc6c590a\",\r\n        current_stage: 1,\r\n        current_level: 1,\r\n        current_score: 0,\r\n        expert_scale: 30,\r\n        master_scale: 50,\r\n        drawer_open: false,\r\n        tab_selected: \"1\",\r\n        times: [timestamp()],\r\n        dark_theme: false,\r\n\r\n        levels: {\r\n            stage1: {\r\n                1: {\r\n                    format: \"2\",\r\n                    info: \"2 digit numbers only\",\r\n                    highscore: 0,\r\n                    pass: 75\r\n                },\r\n                2: {\r\n                    format: \"3\",\r\n                    info: \"3 digit numbers only\",\r\n                    highscore: 0,\r\n                    pass: 75\r\n                },\r\n                3: {\r\n                    format: \"2-3\",\r\n                    info: \"2 and 3 digit numbers\",\r\n                    highscore: 0,\r\n                    pass: 75\r\n                },\r\n                4: {\r\n                    format: \"3|3\",\r\n                    info: \"2 groups of 3 digit numbers\",\r\n                    highscore: 0,\r\n                    pass: 75\r\n                },\r\n                5: {\r\n                    format: \"4\",\r\n                    info: \"4 digit numbers only\",\r\n                    highscore: 0,\r\n                    pass: 75\r\n                },\r\n                6: {\r\n                    format: \"2-4|2-4\",\r\n                    info: \"2 groups of 2-4 digit numbers\",\r\n                    highscore: 0,\r\n                    pass: 75\r\n                },\r\n                7: {\r\n                    format: \"2-3|2-3|2-3|2-3\",\r\n                    info: \"4 groups of 2-3 digit numbers\",\r\n                    highscore: 0,\r\n                    pass: 75\r\n                },\r\n                8: {\r\n                    format: \"4|3|3\",\r\n                    info: \"Phone numbers\",\r\n                    highscore: 0,\r\n                    pass: 75\r\n                },\r\n                9: {\r\n                    format: \"5|5|5|5|5\",\r\n                    info: \"Credit card numbers\",\r\n                    highscore: 0,\r\n                    pass: 75\r\n                },\r\n                10: {\r\n                    format: \"40\",\r\n                    info: \"40 digit mega numbers\",\r\n                    highscore: 0,\r\n                    pass: 75\r\n                }\r\n            },\r\n            stage2: {\r\n                1: {\r\n                    format: \"2-3\",\r\n                    info: \"1 word with 2 or 3 digits\",\r\n                    highscore: 0,\r\n                    pass: 75\r\n                },\r\n                2: {\r\n                    format: \"2-3|2-3\",\r\n                    info: \"2 words with 2 or 3 digits each\",\r\n                    highscore: 0,\r\n                    pass: 75\r\n                },\r\n                3: {\r\n                    format: \"2-5\",\r\n                    info: \"2 to 5 digits in one word\",\r\n                    highscore: 0,\r\n                    pass: 75\r\n                },\r\n                4: {\r\n                    format: \"2|3|4\",\r\n                    info: \"10 digits in 3 words\",\r\n                    highscore: 0,\r\n                    pass: 75\r\n                },\r\n                5: {\r\n                    format: \"4|4|4|4|4\",\r\n                    info: \"20 digits in 5 words\",\r\n                    highscore: 0,\r\n                    pass: 75\r\n                }\r\n            }\r\n        },\r\n    }\r\n\r\n    this.save = function() {\r\n        console.log(\"Saving:\", this.__appdata__);\r\n        window.localStorage.setItem(this.__appdata__.storage_key, JSON.stringify(this.__appdata__));\r\n    }\r\n\r\n    this.load = function() {\r\n        var read = JSON.parse(window.localStorage.getItem(this.__appdata__.storage_key));\r\n        if (typeof(read) == \"object\" && read !== null) {\r\n            this.__appdata__ = read;\r\n        } else {\r\n            this.save();\r\n        }\r\n    }\r\n    this.get = function(key) {\r\n        return (this.__appdata__[key] === undefined) ? false : this.__appdata__[key];\r\n    }\r\n    this.set = function(key, value) {\r\n        if (typeof(key) == 'object' && !value) {\r\n            for (i in key){\r\n                this.__appdata__[i] = key[i]\r\n            }\r\n        } else {\r\n            this.__appdata__[key] = value;\r\n        }\r\n        this.save();\r\n    }\r\n    this.reset = function(){\r\n        window.localStorage.removeItem(this.__appdata__.storage_key);\r\n    }\r\n\r\n    this.init = function(){\r\n        this.load();\r\n        var a = this.__appdata__.levels;\r\n        for (var stage in a) {\r\n            for (var i in a[stage]){\r\n                a[stage][i].state = function(){\r\n                    if (this.highscore >= (this.pass + save_file.get(\"master_scale\"))) {\r\n                        return 4\r\n                    } else if (this.highscore >= (this.pass + save_file.get(\"expert_scale\"))) {\r\n                        return 3\r\n                    } else if (this.highscore >= this.pass) {\r\n                        return 2\r\n                    };\r\n                    switch (this.highscore) {\r\n                        case 0:\r\n                            return 0\r\n                        default:\r\n                            return 1\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n})();","/*\r\n\r\n    Pull in a dictionary or use a webservice to generate a word\r\n    for a number in the MajMonic system.\r\n\r\n*/\r\n\r\n\r\nvar WordGenerator = new (function() {\r\n    // this.serviceUrl = \"http://majorsystem.com/generator\"; // NEED TO ADD FALLBACK TO THIS\r\n    this.dictUrl = \"./dictionary/major_dictionary.txt\";\r\n    this.dictUuid = \"MajorTrainingDictionary-60b02baf-b5cf-4851-ad39-1644bd5dd5ec\";\r\n    this.dictionaryError = false;\r\n    this.dictionaryLoaded = false;\r\n\r\n    this.requestDictionary = function() {\r\n        var localStorage_db = window.localStorage.getItem(this.dictUuid);\r\n\r\n        try {\r\n            if (localStorage_db) {\r\n                this.onDictionaryGet(JSON.parse(localStorage_db), \"Loaded from localstorage! B)\");\r\n            } else if (this.isOffline()) {\r\n                this.requestLocalFile();\r\n            } else {\r\n                this.promptForDictionary();\r\n            }\r\n        } catch(e) {\r\n            this.clearDictionaryFromLocalStorage();\r\n        }\r\n    }\r\n\r\n    this.clearDictionaryFromLocalStorage = function(){\r\n        window.localStorage.removeItem(this.dictUuid);\r\n    }\r\n\r\n    this.promptForDictionary = function(){\r\n        this.getfileSize(this.dictUrl, function(size){\r\n            if (size) {\r\n                display.modify.inputPrompt_dictButton(\"Download (\" + (size/1000000).toFixed(2) + \" MB\" + \")\");\r\n            }\r\n        })\r\n        elements.list.input.prompt_dict.button.addEventListener('click', function(){\r\n            try {\r\n                WordGenerator.ajaxMakeRequest(WordGenerator.dictUrl, WordGenerator.onDictionaryGet, WordGenerator.onDictionaryError)\r\n                elements.list.input.prompt_dict.button.style.display = \"none\";\r\n                display.modify.inputPrompt_dictMessage(\"<b>Loading</b> <span class='spinner'></span> (Expect freezing for about 30sec)\")\r\n            } catch(e) {\r\n                console.log(e);\r\n            }\r\n        })\r\n    }\r\n\r\n    this.getfileSize = function(url, callback) {\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open('HEAD', url);\r\n        xhr.addEventListener('readystatechange', function(){\r\n            if (xhr.readyState === XMLHttpRequest.DONE) {\r\n                if (this.status === 200) {\r\n                    callback(xhr.getResponseHeader(\"Content-Length\"));\r\n                } else {\r\n                    return false;\r\n                }\r\n            }\r\n        });\r\n        xhr.send();\r\n    }\r\n\r\n    this.ajaxMakeRequest = function(url, success, failure) {\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open('GET', url);\r\n        if (xhr.readyState === 4 && xhr.response === \"\"){\r\n            failure.call(xhr.superclass, \"AJAX request could not be made (probably because offline?)\");\r\n            return false;\r\n        }\r\n\r\n        var superclass = this;\r\n        xhr.addEventListener('readystatechange', function(){\r\n            if (this.readyState === XMLHttpRequest.DONE) {\r\n                if (this.status === 200) {\r\n                    return success.call(superclass, superclass.dictionaryToDatabase(this.response), \"Had to get it from server :/\") || true;\r\n                } else {\r\n                    return failure.call(superclass, this) || false;\r\n                }\r\n            }\r\n        });\r\n        xhr.send();\r\n    }\r\n\r\n    this.requestLocalFile = function() {\r\n        elements.list.input.local_dict.filechooser.style.display = \"block\";\r\n        elements.list.input.local_dict.messages.style.display = \"block\";\r\n        elements.list.input.local_dict.filechooser.superclass = this; // HACK for Context\r\n        elements.list.input.local_dict.filechooser.addEventListener('change', this.readLocalFile)\r\n    }\r\n\r\n    this.readLocalFile = function(e) {\r\n        if (!e) {return false}\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n\r\n        var file = e.target.files[0] || null\r\n        if (!file) {return false}\r\n\r\n        var reader = new FileReader();\r\n        var superclass = this.superclass; // HACK for Context\r\n        reader.onload = function(evt){\r\n            try {\r\n                superclass.onDictionaryGet(superclass.dictionaryToDatabase(reader.result), \"Loaded from local file! \\\\(^.^)/\");\r\n                display.modify.inputLocal_dictMessages(\"Thank you! (^.^)\");\r\n                elements.list.input.local_dict.filechooser.style.display = \"none\";\r\n            } catch(err) {\r\n                superclass.onDictionaryError(\"Could not parse local file as JSON\");\r\n            }\r\n        }\r\n        reader.readAsText(file);\r\n    }\r\n\r\n    this.isOffline = function(){\r\n        return (window.location.href.indexOf(\"file:///\") >= 0) || false\r\n    }\r\n\r\n    this.onDictionaryGet = function(dict, msg){\r\n        msg = msg || \"\";\r\n        try {\r\n            this.db = dict;\r\n            if (typeof(this.db) === \"object\"){\r\n                window.localStorage.setItem(this.dictUuid, JSON.stringify(this.db));\r\n                console.info(\"Generator dictionary is up and running!\", msg)\r\n                this.dictionaryLoaded = true;\r\n                elements.list.input.prompt_dict.button.style.display = \"none\";\r\n                elements.list.input.prompt_dict.message.style.display = \"none\";\r\n            } else {\r\n                throw(Error(\"Generator dictionary not retreived as object\"))\r\n            }\r\n        } catch(e) {\r\n            this.onDictionaryError(e);\r\n        }\r\n    }\r\n\r\n    this.onDictionaryError = function(msg){\r\n        msg = msg || \"\";\r\n        this.dictionaryError = true;\r\n        console.warn(\"WordGenerator: Sorry, the generator is broken :/\\n\", msg);\r\n        display.modify.inputPrompt_dictMessage(\"<b>This is embarrassing...</b><br>The dictionary didn't load properly :/. If this happens again, you should definitely <a href='https://github.com/cemrajc/majortraining/issues'>file a bug report</a>.\")\r\n    }\r\n\r\n\r\n    this.dictionaryToDatabase = function(dict){\r\n        var words = dict.split(\"\\n\");\r\n        var db = {};\r\n        for (var i in words){\r\n            if (!this.matchesDictionaryFilter(words[i])) { continue; }\r\n            var indices = game.explodePossibleNumToNums(game.possibleNumFromWord(words[i]));\r\n            for (var index in indices) {\r\n                if (!db[indices[index]]) {\r\n                    db[indices[index]] = [];\r\n                }\r\n                db[indices[index]].push(words[i])\r\n            }\r\n        }\r\n        return db;\r\n    }\r\n\r\n    this.matchesDictionaryFilter = function(word) {\r\n        return /^[a-z]+$/i.test(word);\r\n    }\r\n\r\n\r\n    this.getWordsFromNum = function(num) {\r\n        num = parseInt(num);\r\n        if (!this.dictionaryLoaded) {\r\n            return \"Need dictionary! (Go to the generator tab)\";\r\n        } else if (this.db[num]) {\r\n            return this.db[num];\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    this.getWordFromNum = function(num) {\r\n        if (this.dictionaryLoaded && this.db[num]) {\r\n            var working_set = this.db[num];\r\n            var random_index = Math.round(Math.random() * (working_set.length - 1));\r\n            return titleCase(working_set[random_index]) || \"<i>Error occurred :(</i>\";\r\n        } else {\r\n            if (this.dictionaryError) {\r\n                return \"<i>Sorry, it's broken :(</i>\"\r\n            } else if (this.dictionaryLoaded) {\r\n                return \"<i>No word found</i>\"\r\n            } else {\r\n                return \"<i>Waiting for dictionary</i>\"\r\n            }\r\n        }\r\n    }\r\n    this.getWord = this.getWordFromNum;\r\n\r\n\r\n    this.init = function() {\r\n        this.requestDictionary();\r\n    }\r\n})();"],"sourceRoot":"/source/"}