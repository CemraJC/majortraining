{"version":3,"sources":["display.js","dom_elements.js","fontscale.js","game_logic.js","global_util.js","inputs_handler.js","save_file.js","word_generator.js"],"names":["display","this","modify","getContentProperty","element","nodeName","replaceElementContent","content","getElementContent","toggleAttribute","attribute","getAttribute","removeAttribute","setAttribute","toggleDrawer","elements","list","input","drawer","replaceOrGetContent","undefined","updateReadout","obj","current_level","save_file","get","current_score","level","textReadoutScore","textReadoutHighscore","highscore","textReadoutLevel","textReadoutLevelinfo","info","counter","read","parseInt","text","count","innerHTML","toggleTheme","a","document","body","getReferenceItem","number","ms_array","join","getMenuItem","level_num","s","state","selectLevel","override","current","querySelector","select","firstChild","next","getLevelsList","i","getReferenceList","setMenuTabs","tabs","selected","length","value","updateReferenceList","reference","updateLevelsList","textSelect","triggerElementGlow","color","style","transition","boxShadow","setTimeout","goodGlow","main","badGlow","__generateSpecifics","lvl","path","valid","nodeType","e","console","error","index","titleCase","Function","bind","init","__s","mainsection","tabmenu","container","levels","readout","settings","generator","score","levelinfo","button","skip","theme","reset","tab_labels","local_dict","filechooser","messages","prompt_dict","message","word","output","item","found","querySelectorAll","fontScale","wordWrap","recalculate","addWrapper","recalculateElement","eh","offsetHeight","ew","offsetWidth","ph","getNominalHeight","pw","getNominalWidth","height_ratio","Math","max","width_ratio","scaleHeight","scaleWidth","ratio","fontSize","parentElement","mh","Infinity","min","mw","classList","game","generateWord","generateNum","textMain","__generateNumFromFormat","format","groups","split","result","digit_range","__generateDigitGroup","range","single_digit","break_probability","round","random","checkNum","num","__matchPossibleNum","possibleNumFromWord","letters","__wordToLetters","possible_num","ms","indexOf","push","__letterToNums","explodePossibleNumToNums","explodedNums","max_index","__recursiveSerialJoinArrays","arrays","reduced_arrays","slice","__serialJoinArrays","next_array","arr1","arr2","b","toString","possibleWordFromNum","exploded","removeSuccessiveDuplicates","trim","toLowerCase","multi","letter","nums","exploded_num","addTimestamp","timestamp","updateScore","times","level_i","__calculateScore","set","MAX_PAST","scaler","timelen","pastinterval","timediff","wpm","reload","window","location","array","floor","Date","now","string","toUpperCase","0","1","2","3","4","5","6","7","8","9","getTime","inputs","themeListener","generatorListener","WordGenerator","getWord","generatorNumber","generatorOutput","tabsListener","checked","drawerListener","skipListener","resetListener","detail","clearDatabaseFromLocalStorage","levelSelectListener","clicked","target","new_level","inputMain","mainInputListener","keyCode","check","updateMenuList","addEventListener","__appdata__","storage_key","current_stage","expert_scale","master_scale","drawer_open","tab_selected","dark_theme","pass","10","save","log","localStorage","setItem","JSON","stringify","load","parse","getItem","key","removeItem","dictUrl","dictUuid","dictionaryError","dictionaryLoaded","requestDictionary","localStorage_db","onDictionaryGet","isOffline","requestLocalFile","promptForDictionary","clearDictionaryFromLocalStorage","getfileSize","size","inputPrompt_dictButton","toFixed","ajaxMakeRequest","onDictionaryError","inputPrompt_dictMessage","url","callback","xhr","XMLHttpRequest","open","readyState","DONE","status","getResponseHeader","send","success","failure","response","call","superclass","dictionaryToDatabase","readLocalFile","preventDefault","stopPropagation","file","files","reader","FileReader","onload","evt","db","inputLocal_dictMessages","err","readAsText","href","dict","msg","Error","warn","words","indices","getWordFromNum","working_set","random_index"],"mappings":"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","file":"main.js","sourcesContent":["\r\nvar display = new (function() {\r\n    // This will store the specific elements when generated on init\r\n    this.modify = {};\r\n\r\n    this.getContentProperty = function(element){\r\n        if (element.nodeName == \"INPUT\") {\r\n            return 'value'\r\n        } else {\r\n            return 'innerHTML'\r\n        }\r\n    }\r\n\r\n    this.replaceElementContent = function(element, content) {\r\n        element[this.getContentProperty(element)] = content;\r\n    }\r\n\r\n    this.getElementContent = function(element) {\r\n        return element[this.getContentProperty(element)];\r\n    }\r\n\r\n    this.toggleAttribute = function(element, attribute) {\r\n        if (element.getAttribute(attribute) !== null) {\r\n            element.removeAttribute(attribute);\r\n        } else {\r\n            element.setAttribute(attribute, '');\r\n        }\r\n    }\r\n\r\n    this.toggleDrawer = function() {\r\n        this.toggleAttribute(elements.list.input.drawer, 'checked')\r\n    }\r\n\r\n    this.replaceOrGetContent = function(element, content) {\r\n        if (content === undefined){\r\n            return this.getElementContent(element);\r\n        } else {\r\n            this.replaceElementContent(element, content);\r\n            return true;\r\n        }\r\n    }\r\n\r\n    this.updateReadout = function(){\r\n        var obj = {\r\n            current_level: save_file.get('current_level'),\r\n            current_score: save_file.get('current_score')\r\n        }\r\n        obj.level = save_file.get('levels')[obj.current_level];\r\n\r\n        this.modify.textReadoutScore(obj.current_score)\r\n        this.modify.textReadoutHighscore( obj.level.highscore)\r\n        this.modify.textReadoutLevel(\"Level \" + obj.current_level)\r\n        this.modify.textReadoutLevelinfo(obj.level.info)\r\n        return true;\r\n    }\r\n\r\n    this.counter = function() {\r\n        var read = parseInt(elements.list.text.count.innerHTML) || 0;\r\n        elements.list.text.count.innerHTML = read + 1;\r\n    }\r\n\r\n    this.toggleTheme = function() {\r\n        var a = document.body.getAttribute('dark');\r\n        if(a == false || a == undefined){\r\n            document.body.setAttribute('dark', true)\r\n        } else {\r\n            document.body.removeAttribute('dark');\r\n        }\r\n    }\r\n\r\n    this.getReferenceItem = function(number) {\r\n        return ms_array[number].join(\", \") || \"?\";\r\n    }\r\n\r\n    this.getMenuItem = function(level_num) {\r\n        var obj = save_file.get('levels')[level_num], s;\r\n        if (save_file.get('current_level') == level_num){\r\n            s = \"selected\";\r\n        } else {\r\n            s = \"\";\r\n        }\r\n\r\n        return \"<li \" + s + \" levelnum='\" + level_num + \"'><h4>Level \" + level_num + \"<span>\" + obj.highscore + \"</span></h4>\\n<small>\" + obj.info + \"</small><span progression=\\\"\" + obj.state() + \"\\\"></span></li>\\n\";\r\n    }\r\n\r\n    this.selectLevel = function(level_num, override){\r\n        // If these were separate, would have to pass them around in an object and probably save which one?? (maybe just init)\r\n        var current = document.querySelector('li[selected]') || elements.list.text.select.firstChild,\r\n            next = document.querySelector('li[levelnum=\"' + level_num + '\"]');\r\n\r\n        if ((current == next || !next) && !override) {\r\n            return false\r\n        } else {\r\n            current.removeAttribute('selected');\r\n            next.setAttribute('selected', '');\r\n            return true\r\n        };\r\n    }\r\n\r\n    this.getLevelsList = function() {\r\n        var obj = save_file.get('levels'),\r\n            list = \"\";\r\n\r\n        for (i in obj) {\r\n            list += this.getMenuItem(i);\r\n        }\r\n        return list\r\n    }\r\n\r\n    this.getReferenceList = function() {\r\n        var list = \"\";\r\n        for (var i = 0; i <= 9; i++) {\r\n            list += \"<tr><td>\" + i + \"</td> <td>\" + this.getReferenceItem(i) + \"</td></tr>\";\r\n        };\r\n        return list;\r\n    }\r\n\r\n    this.setMenuTabs = function(){\r\n        var a = elements.list.input.tabs,\r\n            selected = save_file.get('tab_selected');\r\n        for (var i = 0; i < a.length; i++) {\r\n            if(a[i].value === selected){\r\n                a[i].setAttribute('checked', '');\r\n            }\r\n        }\r\n    }\r\n\r\n    this.updateReferenceList = function() {\r\n        this.modify.reference(this.getReferenceList());\r\n    }\r\n\r\n    this.updateLevelsList = function() {\r\n        this.modify.textSelect(this.getLevelsList());\r\n    }\r\n\r\n\r\n    /* Notification / Feedback system */\r\n    this.triggerElementGlow = function(element, color){\r\n        if (!color) { return false; }\r\n\r\n        // Ultra Jank Animation of some properties\r\n\r\n        element.style.transition = 'none';\r\n        element.style.boxShadow = '0 0 0.5em ' + color + ' inset';\r\n        setTimeout(function(){\r\n            element.style.transition = \"all 2s\";\r\n        }, 20);\r\n        setTimeout(function(){\r\n            element.style.boxShadow = '';\r\n        }, 40);\r\n        return true;\r\n    }\r\n    this.goodGlow = function(){\r\n        this.triggerElementGlow(elements.list.input.main, \"#3A8900\");\r\n    };\r\n    this.badGlow = function(){\r\n        this.triggerElementGlow(elements.list.input.main, \"#B31500\");\r\n    };\r\n\r\n\r\n    /* Element specifics are auto-generated on init */\r\n    this.__generateSpecifics = function(obj, lvl, path) {\r\n        obj = obj || elements.list;\r\n        lvl = lvl || 1;\r\n        path = path || \"\";\r\n        if (lvl > 10) { return false; }\r\n\r\n        for (i in obj) {\r\n            try {\r\n                var valid = obj[i].nodeType;\r\n            } catch(e) {\r\n                console.error(\"Element selector problem:\", i, e);\r\n            }\r\n            if (valid !== undefined) {\r\n                var index = (path) ? titleCase(i) : i;\r\n                this.modify[path + index] = new Function('content', 'return this.replaceOrGetContent(this.modify.' + path + index + '__element, content);').bind(this);\r\n                this.modify[path + index + \"__element\"] = obj[i];\r\n            } else {\r\n                this.__generateSpecifics(obj[i], lvl + 1, (lvl > 1) ? path + titleCase(i) : path + i);\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n\r\n    this.init = function(){\r\n        this.__generateSpecifics()\r\n        if ( save_file.get('dark_theme') ) { this.toggleTheme() }\r\n        if ( save_file.get('drawer_open') ) { this.toggleDrawer() }\r\n        this.setMenuTabs();\r\n        this.updateLevelsList();\r\n        this.updateReferenceList();\r\n        this.updateReadout();\r\n        this.selectLevel(save_file.get('current_level'), true);\r\n    }\r\n})();","var elements = new (function() {\r\n    this.__s = { // __selectors - not really meant to be used by programmers\r\n        mainsection: \".maincolumn .main\",\r\n        tabmenu: {\r\n            container: \"#drawer-tabs .tab-container\",\r\n            levels: {\r\n                container: \"#drawer-tabs .tab-container .tab-panel.levelscolumn#tab-1 \",\r\n                readout: \"#drawer-tabs .tab-container .tab-panel.levelscolumn#tab-1 .readout\",\r\n                select: \"#drawer-tabs .tab-container .tab-panel.levelscolumn#tab-1 .select\",\r\n                settings: \"#drawer-tabs .tab-container .tab-panel#tab-1 .settings\"\r\n            },\r\n            generator: {\r\n                container: \"#drawer-tabs .tab-container .tab-panel.generatorscolumn#tab-2 \",\r\n            },\r\n            reference:{\r\n                container: \"#drawer-tabs .tab-container .tab-panel.referencecolumn#tab-3 \",\r\n            }\r\n        }\r\n    }\r\n\r\n    this.list = {\r\n        text: {\r\n            main: this.__s.mainsection + \" p.generated\",\r\n            readout: {\r\n                container: this.__s.tabmenu.levels.readout,\r\n                score: this.__s.tabmenu.levels.readout + \" .score\",\r\n                highscore: this.__s.tabmenu.levels.readout + \" .highscore\",\r\n                level: this.__s.tabmenu.levels.readout + \" .level\",\r\n                levelinfo: this.__s.tabmenu.levels.readout + \" .levelinfo\"\r\n            },\r\n            select: this.__s.tabmenu.levels.container + \" .select ul\",\r\n            count: this.__s.mainsection + \" .numbar span.count\"\r\n        },\r\n        button: {\r\n            skip: this.__s.mainsection + \" .numbar a.skip\",\r\n            theme: this.__s.tabmenu.levels.settings + \" input[name=theme]\",\r\n            reset: this.__s.tabmenu.levels.settings + \" input[name=reset]\"\r\n        },\r\n        input: {\r\n            main: this.__s.mainsection + \" input[name=main_input]\",\r\n            tabs: \"#drawer input[type=radio]\",\r\n            tab_labels: \"#drawer .tab-buttons\",\r\n            drawer: \"input[type=checkbox]#drawer-toggle\",\r\n            local_dict: {\r\n                filechooser: this.__s.tabmenu.generator.container + \" input[type=file].submit_dict\",\r\n                messages: this.__s.tabmenu.generator.container + \" p.submit_dict\"\r\n            },\r\n            prompt_dict: {\r\n                button: this.__s.tabmenu.generator.container + \" button.prompt_dict\",\r\n                message: this.__s.tabmenu.generator.container + \" p.prompt_dict\"\r\n            }\r\n        },\r\n        reference: this.__s.tabmenu.reference.container + \" table tbody\",\r\n        generator: {\r\n            container: this.__s.tabmenu.generator.container,\r\n            word: this.__s.tabmenu.generator.container + \" .inputs button\",\r\n            number: this.__s.tabmenu.generator.container + \" .inputs input[type=number]\",\r\n            output: this.__s.tabmenu.generator.container + \" span.generated_word\"\r\n        }\r\n    }\r\n\r\n    /* INIT ROUTINE */\r\n    this.init = function(obj, lvl){\r\n        obj = obj || this.list;\r\n        lvl = lvl || 1;\r\n        if (lvl > 10) {return false} // Recursion limiter - something has gone pretty wrong.\r\n\r\n\r\n        for (item in obj){\r\n            if (typeof(obj[item]) == \"string\") {\r\n                var found = document.querySelectorAll(obj[item]);\r\n                if (found.length === 1) {\r\n                    found = found[0];\r\n                }\r\n                obj[item] = found;\r\n            } else if (typeof(obj[item]) == \"object\") {\r\n                this.init(obj[item], lvl + 1)\r\n            }\r\n        }\r\n    }\r\n})();","\r\nvar fontScale = new (function(){\r\n\r\n    this.init = function(){\r\n        this.elements = document.querySelectorAll(\"[fs-min-width], [fs-max-width], [fs]\");\r\n\r\n        for (var i = 0; i < this.elements.length; i++) {\r\n            this.elements[i].style.wordWrap = 'none';\r\n        };\r\n        this.recalculate();\r\n    }\r\n\r\n    this.recalculate = function(){\r\n        for (var a = 0; a < this.elements.length; a++) {\r\n            this.addWrapper(this.elements[a]);\r\n            this.recalculateElement(this.elements[a].firstChild);\r\n        };\r\n        console.info(\"Fontscale: Recalculated font size.\")\r\n    }\r\n\r\n    this.recalculateElement = function(element){\r\n        var eh = element.offsetHeight,\r\n            ew = element.offsetWidth,\r\n            ph = this.getNominalHeight(element),\r\n            pw = this.getNominalWidth(element),\r\n            height_ratio = Math.max(ph/eh, 0.01),\r\n            width_ratio  = Math.max(pw/ew, 0.01);\r\n        if (height_ratio < width_ratio) {\r\n            this.scaleHeight(element, height_ratio);\r\n        } else {\r\n            this.scaleWidth(element, width_ratio);\r\n        }\r\n    }\r\n\r\n    this.scaleHeight = function(element, ratio){\r\n        element.style.fontSize = ratio*100 + \"%\";\r\n    }\r\n\r\n    this.scaleWidth = function(element, ratio){\r\n        element.style.fontSize = ratio*100 + \"%\";\r\n    }\r\n\r\n    this.getNominalHeight = function(element){\r\n        var ph = element.parentElement.offsetHeight,\r\n            mh = element.parentElement.getAttribute('fs-max-height')/100 * ph || Infinity;\r\n\r\n        return Math.min(ph, mh);\r\n    }\r\n\r\n    this.getNominalWidth = function(element){\r\n        var pw = element.parentElement.offsetWidth,\r\n            mw = element.parentElement.getAttribute('fs-max-width')/100 * pw || Infinity;\r\n\r\n        return Math.min(pw, mw);\r\n    }\r\n\r\n    this.addWrapper = function (element){\r\n        if (!element.firstChild.classList) {\r\n            element.innerHTML = \"<span class='fontscale'>\" + element.innerHTML + \"</span>\";\r\n        }\r\n    }\r\n});","var game = new (function(){\r\n\r\n\r\n    this.generateWord = function(){\r\n        return \"bung\";\r\n    }\r\n\r\n    this.generateNum = function() {\r\n        display.modify.textMain(this.__generateNumFromFormat(save_file.get('levels')[save_file.get('current_level')].format));\r\n    }\r\n\r\n\r\n    this.__generateNumFromFormat = function(format){\r\n        format = format || \"2-12\"\r\n        var groups = format.split('|');\r\n        var result = [];\r\n\r\n        for (var i = 0; i < groups.length; i++) {\r\n            var digit_range = groups[i].split('-');\r\n            result[i] = this.__generateDigitGroup(digit_range);\r\n        };\r\n\r\n        return result.join(' ');\r\n    }\r\n    this.__generateDigitGroup = function(range) {\r\n        var single_digit, result = \"\";\r\n        if (!range[1]) { range[1] = range[0]; }\r\n        var break_probability = 1 / (range[1] - range[0] + 1);\r\n\r\n        for (var i = 1; i <= range[1]; i++) {\r\n            single_digit = Math.round(Math.random()*9);\r\n            result += single_digit;\r\n            if (i >= range[0] && Math.random() <= break_probability) {\r\n                break;\r\n            };\r\n        };\r\n\r\n        return result;\r\n    }\r\n\r\n    this.checkNum = function(num, word) {\r\n        return this.__matchPossibleNum(num, this.possibleNumFromWord(word));\r\n    }\r\n\r\n    this.possibleNumFromWord = function(word){\r\n        // debugger;\r\n        var letters = this.__wordToLetters(word);\r\n        var possible_num = [];\r\n        for (var i = 0; i < letters.length; i++) {\r\n            if ( this.ms.valid.indexOf(letters[i]) < 0 ) { continue; }\r\n            possible_num.push(game.__letterToNums(letters[i]));\r\n        };\r\n        return (possible_num.length > 0) ? possible_num : false;\r\n    }\r\n\r\n    this.explodePossibleNumToNums = function(possible_num) {\r\n        if (!possible_num) { return false }\r\n        var explodedNums = [], temp = [], max_index = 0;\r\n        // Finc the longest array\r\n        for (var i = 0; i < possible_num.length; i++) {\r\n            (max_index < possible_num[i].length) ? max_index = possible_num[i].length : false;\r\n        };\r\n        // For every array of nums in possible num, recursively join them together\r\n        explodedNums = this.__recursiveSerialJoinArrays(possible_num);\r\n        return explodedNums;\r\n    }\r\n\r\n    // Should pass this an ARRAY\r\n    this.__recursiveSerialJoinArrays = function(arrays, lvl) {\r\n        lvl = lvl || 1;\r\n        if (lvl > 15 || !arrays) {return arrays;} // recursion limiter\r\n        var reduced_arrays = arrays.slice(1);\r\n        reduced_arrays[0] = this.__serialJoinArrays(arrays[0], arrays[1]);\r\n        var next_array = this.__recursiveSerialJoinArrays(reduced_arrays, lvl + 1);\r\n        if (next_array[0]) {\r\n            return next_array;\r\n        } else {\r\n            return arrays;\r\n        }\r\n    }\r\n\r\n    this.__serialJoinArrays = function(arr1, arr2) {\r\n        if (!arr1 || !arr2) { return false; }\r\n        var result = [];\r\n        for (var a in arr1) {\r\n            for (var b in arr2) {\r\n                result.push(arr1[a].toString() + arr2[b].toString())\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    // Need to define for stage 2 / generators\r\n    this.possibleWordFromNum = function(num){\r\n\r\n    }\r\n\r\n    this.__wordToLetters = function(word) {\r\n        if (typeof(word) !== \"string\") {return false}\r\n        var letters = [],\r\n            exploded,\r\n            index;\r\n        exploded = removeSuccessiveDuplicates(word.trim().toLowerCase().split(''));\r\n\r\n        for (var i = 0; i < exploded.length; i++) {\r\n            index = this.ms.multi.indexOf(exploded[i] + exploded[i + 1]);\r\n            if (index >= 0) {\r\n                letters.push(this.ms.multi[index]);\r\n                i++ // Skip the already-processed letter\r\n            } else {\r\n                letters.push(exploded[i])\r\n            }\r\n        };\r\n\r\n        return letters\r\n    }\r\n\r\n    this.__letterToNums = function(letter) {\r\n        nums = [];\r\n        for (i in this.ms) {\r\n            if (i >= 0 && this.ms[i].indexOf(letter) >= 0) {\r\n                nums.push(i);\r\n            }\r\n        };\r\n        return nums;\r\n    }\r\n\r\n    this.__matchPossibleNum = function(num, possible_num){\r\n        exploded_num = num.split('');\r\n        if (exploded_num.length != possible_num.length) {\r\n            return false;\r\n        }\r\n        for (var i = 0; i < exploded_num.length; i++) {\r\n            if (possible_num[i].indexOf(exploded_num[i]) < 0){\r\n                return false\r\n            }\r\n        };\r\n        return true;\r\n    }\r\n\r\n    this.addTimestamp = function(){\r\n        save_file.get('times').push(timestamp());\r\n    }\r\n\r\n    this.updateScore = function(){\r\n        var obj = {\r\n            current_score: save_file.get('current_score'),\r\n            levels: save_file.get('levels'),\r\n            times: save_file.get('times')\r\n        };\r\n        var level_i = save_file.get('current_level');\r\n        obj.current_score = this.__calculateScore(obj)\r\n        // Set high score if current is higher\r\n        if (obj.current_score > obj.levels[level_i].highscore){\r\n            obj.levels[level_i].highscore = obj.current_score;\r\n        }\r\n        save_file.set(obj);\r\n    }\r\n\r\n    this.__calculateScore = function(obj) {\r\n        var MAX_PAST = 4;\r\n        var scaler = display.modify.textMain().length,\r\n            timelen = obj.times.length,\r\n            pastinterval = Math.max(Math.min(MAX_PAST, timelen), 1),\r\n            timediff = (obj.times[timelen-1] - obj.times[timelen-pastinterval]) / 1000,\r\n            wpm = Math.round(Math.min(Math.max((60)/(timediff/pastinterval), 1), 300));\r\n\r\n        if (timelen > MAX_PAST){\r\n            obj.times = obj.times.slice(-5);\r\n        }\r\n\r\n        if (pastinterval <= 2){\r\n            return 10;\r\n        }\r\n        return Math.max(Math.round(wpm*scaler), 0);\r\n    }\r\n\r\n    this.init = function(){\r\n        this.ms = ms_array;\r\n        this.generateNum();\r\n    }\r\n})();","\r\nvar ms_array = {\r\n    0: ['s', 'c', 'z', 'x'],\r\n    1: ['d', 't', 'th'],\r\n    2: ['n'],\r\n    3: ['m'],\r\n    4: ['r'],\r\n    5: ['l'],\r\n    6: ['ch', 'sh', 'j', 'g'],\r\n    7: ['c', 'g', 'ch', 'q', 'k', 'ng', 'ck'],\r\n    8: ['f', 'ph', 'v'],\r\n    9: ['b', 'p'],\r\n    valid: ['s', 'c', 'z', 'x', 'q', 'd', 't', 'th', 'n', 'm', 'r', 'l', 'ch', 'ck', 'sh', 'ph', 'j', 'g', 'k', 'ng', 'f', 'v', 'b', 'p'],\r\n    multi: ['ch', 'ck', 'sh', 'th', 'ng', 'ph']\r\n}\r\n\r\nfunction reload() {\r\n    window.location.reload();\r\n}\r\n\r\nfunction removeSuccessiveDuplicates(array){\r\n    var result = []\r\n    for (var i = 0; i < array.length; i++) {\r\n        if(array[i-1] != array[i]){\r\n            result.push(array[i]);\r\n        }\r\n    };\r\n    return result\r\n}\r\n\r\nfunction timestamp(){\r\n    return Math.floor(Date.now() / 1)\r\n}\r\n\r\n// Shim for unsupporting browsers\r\nif (!Date.now) {\r\n    Date.now = function() { return new Date().getTime(); }\r\n}\r\n\r\nfunction titleCase(string){\r\n    if (!string) { return \"\"; }\r\n    return string[0].toUpperCase() + string.slice(1).toLowerCase();\r\n}","var inputs = new (function(){\r\n    this.themeListener = function(){\r\n        save_file.set('dark_theme', !save_file.get('dark_theme'));\r\n        display.toggleTheme();\r\n    }\r\n\r\n    this.generatorListener = function(e){\r\n        var word = WordGenerator.getWord(display.modify.generatorNumber());\r\n        display.modify.generatorOutput(word);\r\n    }\r\n\r\n    this.tabsListener = function(e){\r\n        var a = elements.list.input.tabs;\r\n        setTimeout(function(){\r\n            for (var i = 0; i < a.length; i++){\r\n                if (a[i].checked) {\r\n                    save_file.set('tab_selected', a[i].value)\r\n                }\r\n            }\r\n        }, 50)\r\n    }\r\n\r\n    this.drawerListener = function(e){\r\n        var state = elements.list.input.drawer.checked;\r\n        if (state) {\r\n            save_file.set('drawer_open', true);\r\n        } else {\r\n            save_file.set('drawer_open', false);\r\n        }\r\n    }\r\n\r\n    this.skipListener = function(e){\r\n        game.generateNum();\r\n    }\r\n\r\n    this.resetListener = function(e){\r\n        if (e.detail >= 2) {\r\n            save_file.reset();\r\n            WordGenerator.clearDatabaseFromLocalStorage();\r\n            reload();\r\n        }\r\n    }\r\n\r\n    this.levelSelectListener = function(e) {\r\n        var clicked, target = e.target;\r\n\r\n        for (var i = 0; i < 3; i++) {\r\n            if (target.nodeName == \"LI\"){\r\n                clicked = target;\r\n                break\r\n            } else {\r\n                target = target.parentElement;\r\n            }\r\n        }\r\n        if (!clicked) { return false; }\r\n\r\n        var new_level = clicked.getAttribute('levelnum');\r\n        if (display.selectLevel(new_level)) {\r\n            save_file.set({\r\n                current_score: 0,\r\n                current_level: new_level\r\n            });\r\n            save_file.set('times', [])\r\n            display.modify.inputMain('');\r\n            game.generateNum();\r\n            display.updateReadout();\r\n            fontScale.recalculate();\r\n        }\r\n    }\r\n\r\n    this.mainInputListener = function(e){\r\n        if (e.keyCode == 13) {\r\n            var check = display.replaceOrGetContent(elements.list.text.main.firstChild) || display.modify.textMain();\r\n            if (game.checkNum(check, display.modify.inputMain())){\r\n                display.modify.inputMain('');\r\n                display.goodGlow();\r\n                display.counter();\r\n\r\n                game.generateNum();\r\n                game.addTimestamp();\r\n                game.updateScore();\r\n\r\n                display.updateReadout();\r\n                display.updateMenuList();\r\n                fontScale.recalculate();\r\n            } else {\r\n                display.badGlow();\r\n            }\r\n        }\r\n    }\r\n\r\n    this.init = function(){\r\n        elements.list.button.theme.addEventListener('click', this.themeListener);\r\n        elements.list.button.reset.addEventListener('click', this.resetListener);\r\n        elements.list.button.skip.addEventListener('click', this.skipListener);\r\n\r\n        elements.list.text.select.addEventListener('click', this.levelSelectListener);\r\n        elements.list.input.main.addEventListener('keyup', this.mainInputListener);\r\n        elements.list.generator.word.addEventListener('click', this.generatorListener);\r\n        elements.list.input.drawer.addEventListener('click', this.drawerListener);\r\n        elements.list.input.tab_labels.addEventListener('click', this.tabsListener);\r\n    }\r\n})();","\r\nvar save_file = new (function() {\r\n    // This is the data that gets saved between game states. Functions for manipulating are in save_file.\r\n    this.__appdata__ = {\r\n        storage_key: \"major_training_242e9989-ffa2-48b6-8f46-4b7dfc6c590a\",\r\n        current_stage: 1,\r\n        current_level: 1,\r\n        current_score: 0,\r\n        expert_scale: 30,\r\n        master_scale: 50,\r\n        drawer_open: false,\r\n        tab_selected: \"1\",\r\n        times: [timestamp()],\r\n        dark_theme: false,\r\n\r\n        levels: {\r\n            1: {\r\n                format: \"2\",\r\n                info: \"2 digit numbers only\",\r\n                highscore: 0,\r\n                pass: 75\r\n            },\r\n            2: {\r\n                format: \"3\",\r\n                info: \"3 digit numbers only\",\r\n                highscore: 0,\r\n                pass: 75\r\n            },\r\n            3: {\r\n                format: \"2-3\",\r\n                info: \"2 and 3 digit numbers\",\r\n                highscore: 0,\r\n                pass: 75\r\n            },\r\n            4: {\r\n                format: \"3|3\",\r\n                info: \"2 groups of 3 digit numbers\",\r\n                highscore: 0,\r\n                pass: 75\r\n            },\r\n            5: {\r\n                format: \"4\",\r\n                info: \"4 digit numbers only\",\r\n                highscore: 0,\r\n                pass: 75\r\n            },\r\n            6: {\r\n                format: \"2-4|2-4\",\r\n                info: \"2 groups of 2-4 digit numbers\",\r\n                highscore: 0,\r\n                pass: 75\r\n            },\r\n            7: {\r\n                format: \"2-3|2-3|2-3|2-3\",\r\n                info: \"4 groups of 2-3 digit numbers\",\r\n                highscore: 0,\r\n                pass: 75\r\n            },\r\n            8: {\r\n                format: \"4|3|3\",\r\n                info: \"Phone numbers\",\r\n                highscore: 0,\r\n                pass: 75\r\n            },\r\n            9: {\r\n                format: \"5|5|5|5|5\",\r\n                info: \"Credit card numbers\",\r\n                highscore: 0,\r\n                pass: 75\r\n            },\r\n            10: {\r\n                format: \"40\",\r\n                info: \"40 digit mega numbers\",\r\n                highscore: 0,\r\n                pass: 75\r\n            }\r\n        },\r\n    }\r\n\r\n    this.save = function() {\r\n        console.log(\"Saving:\", this.__appdata__);\r\n        window.localStorage.setItem(this.__appdata__.storage_key, JSON.stringify(this.__appdata__));\r\n    }\r\n\r\n    this.load = function() {\r\n        var read = JSON.parse(window.localStorage.getItem(this.__appdata__.storage_key));\r\n        if (typeof(read) == \"object\" && read !== null) {\r\n            this.__appdata__ = read;\r\n        } else {\r\n            this.save();\r\n        }\r\n    }\r\n    this.get = function(key) {\r\n        return (this.__appdata__[key] === undefined) ? false : this.__appdata__[key];\r\n    }\r\n    this.set = function(key, value) {\r\n        if (typeof(key) == 'object' && !value) {\r\n            for (i in key){\r\n                this.__appdata__[i] = key[i]\r\n            }\r\n        } else {\r\n            this.__appdata__[key] = value;\r\n        }\r\n        this.save();\r\n    }\r\n    this.reset = function(){\r\n        window.localStorage.removeItem(this.__appdata__.storage_key);\r\n    }\r\n\r\n    this.init = function(){\r\n        this.load();\r\n        var a = this.__appdata__.levels;\r\n        for (i in a){\r\n            a[i].state = function(){\r\n                if (this.highscore >= (this.pass + save_file.get(\"master_scale\"))) {\r\n                    return 4\r\n                } else if (this.highscore >= (this.pass + save_file.get(\"expert_scale\"))) {\r\n                    return 3\r\n                } else if (this.highscore >= this.pass) {\r\n                    return 2\r\n                };\r\n                switch (this.highscore) {\r\n                    case 0:\r\n                        return 0\r\n                    default:\r\n                        return 1\r\n                }\r\n            }\r\n        }\r\n    }\r\n})();","/*\r\n\r\n    Pull in a dictionary or use a webservice to generate a word\r\n    for a number in the MajMonic system.\r\n\r\n*/\r\n\r\n\r\nvar WordGenerator = new (function() {\r\n    // this.serviceUrl = \"http://majorsystem.com/generator\"; // NEED TO ADD FALLBACK TO THIS\r\n    this.dictUrl = \"./dictionary/major_dictionary.txt\";\r\n    this.dictUuid = \"MajorTrainingDictionary-60b02baf-b5cf-4851-ad39-1644bd5dd5ec\";\r\n    this.dictionaryError = false;\r\n    this.dictionaryLoaded = false;\r\n\r\n    this.requestDictionary = function() {\r\n        var localStorage_db = window.localStorage.getItem(this.dictUuid);\r\n\r\n        try {\r\n            if (localStorage_db) {\r\n                this.onDictionaryGet(JSON.parse(localStorage_db), \"Loaded from localstorage! B)\");\r\n            } else if (this.isOffline()) {\r\n                this.requestLocalFile();\r\n            } else {\r\n                this.promptForDictionary();\r\n            }\r\n        } catch(e) {\r\n            this.clearDictionaryFromLocalStorage();\r\n        }\r\n    }\r\n\r\n    this.clearDictionaryFromLocalStorage = function(){\r\n        window.localStorage.removeItem(this.dictUuid);\r\n    }\r\n\r\n    this.promptForDictionary = function(){\r\n        this.getfileSize(this.dictUrl, function(size){\r\n            if (size) {\r\n                display.modify.inputPrompt_dictButton(\"Download (\" + (size/1000000).toFixed(2) + \" MB\" + \")\");\r\n            }\r\n        })\r\n        elements.list.input.prompt_dict.button.addEventListener('click', function(){\r\n            try {\r\n                WordGenerator.ajaxMakeRequest(WordGenerator.dictUrl, WordGenerator.onDictionaryGet, WordGenerator.onDictionaryError)\r\n                elements.list.input.prompt_dict.button.style.display = \"none\";\r\n                display.modify.inputPrompt_dictMessage(\"<b>Loading...</b>\")\r\n            } catch(e) {\r\n                console.log(e);\r\n            }\r\n        })\r\n    }\r\n\r\n    this.getfileSize = function(url, callback) {\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open('HEAD', url);\r\n        xhr.addEventListener('readystatechange', function(){\r\n            if (xhr.readyState === XMLHttpRequest.DONE) {\r\n                if (this.status === 200) {\r\n                    callback(xhr.getResponseHeader(\"Content-Length\"));\r\n                } else {\r\n                    return false;\r\n                }\r\n            }\r\n        });\r\n        xhr.send();\r\n    }\r\n\r\n    this.ajaxMakeRequest = function(url, success, failure) {\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open('GET', url);\r\n        if (xhr.readyState === 4 && xhr.response === \"\"){\r\n            failure.call(xhr.superclass, \"AJAX request could not be made (probably because offline?)\");\r\n            return false;\r\n        }\r\n\r\n        var superclass = this;\r\n        xhr.addEventListener('readystatechange', function(){\r\n            if (this.readyState === XMLHttpRequest.DONE) {\r\n                if (this.status === 200) {\r\n                    return success.call(superclass, superclass.dictionaryToDatabase(this.response), \"Had to get it from server :/\") || true;\r\n                } else {\r\n                    return failure.call(superclass, this) || false;\r\n                }\r\n            }\r\n        });\r\n        xhr.send();\r\n    }\r\n\r\n    this.requestLocalFile = function() {\r\n        elements.list.input.local_dict.filechooser.style.display = \"block\";\r\n        elements.list.input.local_dict.messages.style.display = \"block\";\r\n        elements.list.input.local_dict.filechooser.superclass = this; // HACK for Context\r\n        elements.list.input.local_dict.filechooser.addEventListener('change', this.readLocalFile)\r\n    }\r\n\r\n    this.readLocalFile = function(e) {\r\n        if (!e) {return false}\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n\r\n        var file = e.target.files[0] || null\r\n        if (!file) {return false}\r\n\r\n        var reader = new FileReader();\r\n        var superclass = this.superclass; // HACK for Context\r\n        reader.onload = function(evt){\r\n            try {\r\n                var db = JSON.parse(reader.result);\r\n                superclass.onDictionaryGet(db, \"Loaded from local file! \\\\(^.^)/\");\r\n                display.modify.inputLocal_dictMessages(\"Thank you! (^.^)\");\r\n                elements.list.input.local_dict.filechooser.style.display = \"none\";\r\n            } catch(err) {\r\n                superclass.onDictionaryError(\"Could not parse local file as JSON\");\r\n            }\r\n        }\r\n        reader.readAsText(file);\r\n    }\r\n\r\n    this.isOffline = function(){\r\n        return (window.location.href.indexOf(\"file:///\") >= 0) || false\r\n    }\r\n\r\n    this.onDictionaryGet = function(dict, msg){\r\n        msg = msg || \"\";\r\n        try {\r\n            this.db = dict;\r\n            if (typeof(this.db) === \"object\"){\r\n                window.localStorage.setItem(this.dictUuid, JSON.stringify(this.db));\r\n                console.info(\"Generator dictionary is up and running!\", msg)\r\n                this.dictionaryLoaded = true;\r\n                elements.list.input.prompt_dict.button.style.display = \"none\";\r\n                elements.list.input.prompt_dict.message.style.display = \"none\";\r\n            } else {\r\n                throw(Error(\"Generator dictionary not retreived as object\"))\r\n            }\r\n        } catch(e) {\r\n            this.onDictionaryError(e);\r\n        }\r\n    }\r\n\r\n    this.onDictionaryError = function(msg){\r\n        msg = msg || \"\";\r\n        this.dictionaryError = true;\r\n        console.warn(\"WordGenerator: Sorry, the generator is broken :/\\n\", msg);\r\n        display.modify.inputPrompt_dictMessage(\"<b>This is embarrassing...</b><br>The dictionary didn't load properly :/. If this happens again, you should definitely <a href='https://github.com/cemrajc/majortraining/issues'>file a bug report</a>.\")\r\n    }\r\n\r\n    this.dictionaryToDatabase = function(dict){\r\n        var words = dict.split(\"\\n\");\r\n        var db = {};\r\n        for (var i in words){\r\n            var indices = game.explodePossibleNumToNums(game.possibleNumFromWord(words[i]));\r\n            for (var index in indices) {\r\n                if (!db[indices[index]]) {\r\n                    db[indices[index]] = [];\r\n                }\r\n                db[indices[index]].push(words[i])\r\n            }\r\n        }\r\n        return db;\r\n    }\r\n\r\n\r\n    this.getWordFromNum = function(num) {\r\n        if (this.dictionaryLoaded && this.db[num]) {\r\n            var working_set = this.db[num];\r\n            var random_index = Math.round(Math.random() * (working_set.length - 1));\r\n            return titleCase(working_set[random_index]) || \"<i>Error occurred :(</i>\";\r\n        } else {\r\n            if (this.dictionaryError) {\r\n                return \"<i>Sorry, it's broken :(</i>\"\r\n            } else if (this.dictionaryLoaded) {\r\n                return \"<i>No word found</i>\"\r\n            } else {\r\n                return \"<i>Waiting for dictionary</i>\"\r\n            }\r\n        }\r\n    }\r\n    this.getWord = this.getWordFromNum;\r\n\r\n\r\n    this.init = function() {\r\n        this.requestDictionary();\r\n    }\r\n})();"],"sourceRoot":"/source/"}